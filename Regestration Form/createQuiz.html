<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Quiz</title>
</head>
<body>
    <h1>Create Your Quiz</h1>
    
    <div id="quizForm">
        <label for="quizTitle">Quiz Title:</label>
        <input type="text" id="quizTitle" required>
        
        <div id="questionsContainer">
            <button onclick="addQuestion()">Add Question</button>
        </div>
        
        <button onclick="generateJson()">Generate JSON</button>
    </div>

    <script>
        function addQuestion() {
            const questionsContainer = document.getElementById('questionsContainer');
            
            const questionDiv = document.createElement('div');
            questionDiv.innerHTML = `
                <label for="question">Question:</label>
                <input type="text" name="question" required>
                
                <label for="answers">Answers:</label>
                <textarea name="answers" rows="4" required></textarea>
                
                <label for="correctAnswer">Correct Answer:</label>
                <input type="text" name="correctAnswer" required>
            `;
            
            questionsContainer.appendChild(questionDiv);
        }

        function generateJson() {
            const quizTitle = document.getElementById('quizTitle').value;
            const questionsContainer = document.getElementById('questionsContainer');
            const questions = [];

            const questionDivs = questionsContainer.querySelectorAll('div');
            questionDivs.forEach((questionDiv) => {
                const question = questionDiv.querySelector('[name="question"]').value;
                const answers = questionDiv.querySelector('[name="answers"]').value.split('\n');
                const correctAnswer = questionDiv.querySelector('[name="correctAnswer"]').value;

                const questionObject = {
                    question,
                    answers,
                    correctAnswer
                };

                questions.push(questionObject);
            });

            const quizData = {
                title: quizTitle,
                questions
            };

            const jsonData = JSON.stringify(quizData, null, 2);
            console.log(jsonData);
            // sending to the server ....
            fetch('http://localhost:8080/api/v1/auth/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: jsonData,
    })
    .then(response => {
      if (!response.ok) {
        refreshToken();
        if(!response.ok){
          throw new Error('Login failed');
        }
        
      }
      return response.json();
    })
    .then(data => {
      // Login successful, data may contain user profile information
      console.log('the quiz is set  successful:');


      // You can redirect to another page or update the UI as needed
    })
    .catch(error => {
      console.error('Error:', error);
      // Handle login failure, show an error message, etc.
    });
  }

        
    </script>
</body>
</html>
